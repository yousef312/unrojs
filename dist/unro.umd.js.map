{"version":3,"file":"unro.umd.js","sources":["../src/unro.js"],"sourcesContent":["const algos = ['clearpath', 'insertion', 'lineare'];\r\n\r\nconst dfn = () => { } // dfn stands for Default function\r\nlet counter = 0;\r\nconst clamp = (v, min, max) => v < min ? min : v > max ? max : v;\r\nArray.prototype.insert = function (elm, index) {\r\n    this.splice(clamp(index, 0, this.length), 0, elm);\r\n    return index;\r\n}\r\n\r\n/**\r\n * @typedef {Object} StackDef\r\n * @property {function} undo called when user is attempting to undo action\r\n * @property {function} redo called when user is attempting to redo action\r\n * @property {string} label helps identifiy the stack action\r\n * @property {Date} date the stack action date\r\n */\r\n\r\n/**\r\n * Utility used to to create Canvas Stack\r\n * @typedef {Object} Maker\r\n * @property {(dst: OffscreenCanvasRenderingContext2D|CanvasRenderingContext2D)=>} use Define destination to use in the Stack\r\n * @property {(str: string)=>} label Label the stack\r\n * @property {(step: \"undo\"|\"redo\", src?: OffscreenCanvasRenderingContext2D|CanvasRenderingContext2D|ImageData)=>} register Register `undo` & `redo` calls\r\n * @property {(step: \"unro\"|\"redo\"|()=>, cb?: ()=>)=>} after defines a callback to run after one of the stacks or both\r\n */\r\n\r\n/**\r\n * Simple integration of undo/redo functionalities\r\n * @author Yousef Neji\r\n */\r\nexport class Unro {\r\n    /**\r\n     * The stacks container\r\n     * @type {Array<Stack>}\r\n     */\r\n    #stack = [];\r\n\r\n    /**\r\n     * Last action performed\r\n     * @type {\"undo\" | \"redo\"}\r\n     */\r\n    #last = null;\r\n\r\n    /**\r\n     * Holds a state of whether all stacks are done or not\r\n     * @type {boolean}\r\n     */\r\n    #alldone = false;\r\n\r\n    /**\r\n     * Holds a state of whether all stacks are undone or not\r\n     * @type {boolean}\r\n     */\r\n    #allundone = false;\r\n\r\n    /**\r\n     * List of defined labeled stacks handlers created through `.define` method\r\n     * @type {Array<{ label: string, undo: (params: Object) =>, redo: (params: Object) => }>}\r\n     */\r\n    #defined = [];\r\n\r\n\r\n    /**\r\n     * Used to create canvas stacks\r\n     * @type {Maker}\r\n     */\r\n    #maker = null;\r\n\r\n    constructor() {\r\n\r\n        /**\r\n         * Current stack/state index \r\n         * @type {number} \r\n         */\r\n        this.current = -1;\r\n\r\n        /**\r\n         * Maximum number of stacks that can be held.\r\n         * @type {number}\r\n         */\r\n        this.maximum = 100;\r\n\r\n        /**\r\n         * The algorithme to use when stacking, or the stacking method, may be one of those:\r\n         *  - `clearpath` : once you undo and push new stack the forward stacks will be removed.\r\n         *  - `insertion` : once you undo and push new stack the new one will be inserted in front of the forward stacks.\r\n         *  - `lineare` : once you push new stack it will be always added to the end of the stacks list.\r\n         * \r\n         * by defaults its `clearpath`\r\n         * @type {string}\r\n         */\r\n        this.algo = \"clearpath\";\r\n\r\n        const maker = () => {\r\n            let destination, label, undo, redo, undoCb, redoCb;\r\n            return {\r\n                use: (dst) => {\r\n                    if (\r\n                        dst instanceof OffscreenCanvasRenderingContext2D ||\r\n                        dst instanceof CanvasRenderingContext2D\r\n                    )\r\n                        destination = dst;\r\n                    else throw new Error(`UnroJs Definition Error\\n Parameter passed in \".use\" function must be of type OffscreenCanvasRenderingContext2D or CanvasRenderingContext2D`);\r\n                },\r\n                label: (str) => label = str,\r\n                register: (step, src) => {\r\n                    if (!destination && (!src || (!(src instanceof OffscreenCanvasRenderingContext2D) && !(src instanceof CanvasRenderingContext2D))))\r\n                        throw new Error(`UnroJs Defintion Error\\n \".register\" is missing the source parameter`)\r\n                    const f = src || destination;\r\n                    switch (step) {\r\n                        case \"undo\":\r\n                            undo = f instanceof ImageData ? f : f.getImageData(0, 0, f.canvas.width, f.canvas.height);\r\n                            break;\r\n                        case \"redo\":\r\n                            redo = f instanceof ImageData ? f : f.getImageData(0, 0, f.canvas.width, f.canvas.height);\r\n                            break;\r\n                    }\r\n                },\r\n                after: (step, cb) => {\r\n                    if (step === \"undo\" && typeof cb === \"function\")\r\n                        undoCb = cb;\r\n                    else if (step === \"redo\" && typeof cb === \"function\")\r\n                        redoCb = cb;\r\n                    else if (typeof step === \"function\") {\r\n                        undoCb =\r\n                            redoCb =\r\n                            step;\r\n                    }\r\n                },\r\n                process: function () {\r\n                    if (!(this instanceof Unro))\r\n                        throw new Error(`UnroJs Error\\n\".process\" function is only callable from within Unro class`);\r\n                    if (!undo || !redo || !destination)\r\n                        throw new Error(`UnroJs Definition Error\\n Definition is missing \"undo\" or \"redo\" stacks or destination CanvasContext! make sure to call \".register(stack)\" and \".use(dst)\" from within the maker`);\r\n                    let nst = new Stack({\r\n                        undo: function () {\r\n                            this.load(\"source\").putImageData(this.load(\"undo\"), 0, 0);\r\n                            if (this.load(\"undo-cb\")) this.load(\"undo-cb\")();\r\n                        },\r\n                        redo: function () {\r\n                            this.load(\"source\").putImageData(this.load(\"redo\"), 0, 0);\r\n                            if (this.load(\"redo-cb\")) this.load(\"redo-cb\")();\r\n                        },\r\n                        label\r\n                    });\r\n                    nst.save(\"source\", destination);\r\n                    nst.save(\"undo\", undo);\r\n                    nst.save(\"redo\", redo);\r\n                    if (typeof undoCb === \"function\") nst.save(\"undo-cb\", undoCb);\r\n                    if (typeof redoCb === \"function\") nst.save(\"redo-cb\", redoCb);\r\n                    return nst;\r\n                },\r\n                kill: function () {\r\n                    if (!(this instanceof Unro))\r\n                        throw new Error(`UnroJs Error\\n\".kill\" function is only callable from within Unro class`);\r\n                    redo =\r\n                        undo =\r\n                        label =\r\n                        destination = undefined;\r\n                    // now we can re-use the make over and over again!\r\n                }\r\n            }\r\n        }\r\n\r\n        this.#maker = maker();\r\n    }\r\n\r\n\r\n    get lastAction() {\r\n        return this.#last;\r\n    }\r\n\r\n    get isFirstStack() {\r\n        return this.#allundone === true;\r\n    }\r\n\r\n    get isLastStack() {\r\n        return this.#alldone === true;\r\n    }\r\n\r\n    /**\r\n     * Push new stack/state into the stacks list, and directly execute unless\r\n     * you set `dontExecute` as true.\r\n     * @method Unro#push\r\n     * @param {StackDef|(mk: Maker)=>} stackdef\r\n     * @param {Object} params\r\n     * @returns {number} the current state index\r\n     */\r\n    push(stackdef, params) {\r\n        if (!stackdef ||\r\n            (stackdef.toString() !== '[object Object]' &&\r\n                !['string', 'function'].includes(typeof stackdef))) return;\r\n\r\n        if (typeof stackdef === \"string\") {\r\n            let hnd = this.#defined.find(a => a.label === stackdef);\r\n            if (hnd)\r\n                stackdef = {\r\n                    undo: function () {\r\n                        hnd.undo(params);\r\n                    },\r\n                    redo: function () {\r\n                        hnd.redo(params);\r\n                    }\r\n                }\r\n            else return;\r\n        }\r\n        let stack;\r\n        if (typeof stackdef === \"function\") {\r\n            stackdef(this.#maker);\r\n            stack = this.#maker.process.call(this);\r\n            this.#maker.kill.call(this); // reset for an other use later \r\n        } else if (typeof stackdef.undo != \"function\" || typeof stackdef.redo != \"function\")\r\n            throw new Error(`[UnroJS] wrong stack defintion in .push, a stack must have undo & redo or init functions`);\r\n        else stack = new Stack(stackdef);\r\n\r\n        // let's prepare the stack state storage\r\n        let oldIndex = this.current;\r\n\r\n        if (this.algo === 'lineare')\r\n            this.current = this.#stack.push(stack) - 1;\r\n        else if (this.algo === 'clearpath') {\r\n            if (this.#stack[oldIndex + 1] !== undefined)\r\n                this.#stack.splice(oldIndex + 1, this.#stack.length);\r\n            this.current = this.#stack.push(stack) - 1;\r\n        } else if (this.algo === 'insertion') {\r\n            this.current = this.#stack.insert(stack, oldIndex + 1);\r\n        }\r\n\r\n        // respect maximum term\r\n        if (this.#stack.length > this.maximum) {\r\n            this.#stack.shift();\r\n            this.current = oldIndex;\r\n        }\r\n\r\n        this.#allundone = false; // we just add a new stack so continue\r\n        return this.current;\r\n    }\r\n    /**\r\n     * Undo the last change or state/stack\r\n     * @method Unro#undo\r\n     * @returns {Unro}\r\n     */\r\n    undo() {\r\n        if (this.#allundone) return;\r\n        // executing\r\n        this.#last = \"undo\";\r\n        this.#stack[this.current].undo(this);\r\n        // decreasing\r\n        if (this.current > -2)\r\n            this.current--;\r\n        if (this.current < 0)\r\n            return this.#allundone = true;\r\n\r\n        this.#alldone = false;\r\n        return this;\r\n    }\r\n    /**\r\n     * Redo the last change or state/stack\r\n     * @method Unro#redo\r\n     * @returns {Unro}\r\n     */\r\n    redo() {\r\n        // increasing\r\n        if (this.#stack[this.current + 1])\r\n            this.current++;\r\n        else return this.#alldone = true;\r\n\r\n        // executing\r\n        this.#stack[this.current].redo(this);\r\n        this.#last = \"redo\";\r\n        this.#allundone = false;\r\n        return this;\r\n    }\r\n    /**\r\n     * Expand the stack maximum length\r\n     * @method Unro#expand\r\n     * @param {number} value\r\n     * @returns {Unro}\r\n     */\r\n    expand(value) {\r\n        this.maximum = typeof value == \"number\" ? value : this.maximum;\r\n        return this\r\n    }\r\n    /**\r\n     * Clear/reset the stack content\r\n     * @method Unro#free\r\n     * @returns {Unro}\r\n     */\r\n    free() {\r\n        this.#stack = [];\r\n        this.current = 0;\r\n        return this\r\n    }\r\n    /**\r\n     * Move to a specified stack, the function will execute all stack up to \r\n     * the one requested, and return either the stack or:\r\n     *  - `out-of-range`: when requested stack index doesn't exists\r\n     *  - `current`: if requested stack is the current one\r\n     * @method Unro#moveTo\r\n     * @param {number} i \r\n     * @returns {string} the wanted stack content or the string `out-of-rang`\r\n     */\r\n    moveTo(i) {\r\n        if (i === this.current) return 'current';\r\n        if (this.#stack[i]) {\r\n            // you can't just jump from age 20 to 55\r\n            // you must go through all between\r\n            // the same happens here\r\n            if (i > this.current)\r\n                for (let j = this.current + 1; j <= i; j++) {\r\n                    this.current = j; // required for state functionality\r\n                    this.#stack[j].redo(this); // redoing the stack\r\n                }\r\n            else\r\n                for (let j = this.current; j >= i; j--) {\r\n                    this.current = j; // required for state functionality\r\n                    this.#stack[j].undo(this); // undoing the stack\r\n                }\r\n\r\n            this.current = i;\r\n            return this.#stack[i];\r\n        } else return 'out-of-range';\r\n    }\r\n    /**\r\n     * Change the `algo` property value, available options are:\r\n     *  - `clearpath` : once you undo and push new stack the forward stacks will be removed.\r\n     *  - `insertion` : once you undo and push new stack the new one will be inserted in front of the forward stacks.\r\n     *  - `lineare` : once you push new stack it will be always added to the end of the stacks list.\r\n     * @method Unro#setAlgorithme\r\n     * @param {string} algo \r\n     * @returns {boolean}\r\n     */\r\n    setAlgorithme(algo) {\r\n        if (algos.includes(algo)) {\r\n            this.algo = algo;\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n\r\n    /**\r\n     * Creates a JSON stack action string \r\n     * @method Unro#exportStackActions\r\n     * @returns {string}\r\n     */\r\n    exportStackActions() {\r\n        let stacks = [];\r\n        this.#stack.forEach(stk => stacks.push({ action: stk.label, date: stk.date }));\r\n        return JSON.stringify({ stacks });\r\n    }\r\n\r\n    /**\r\n     * Acquire a shortcut library functionality such as qway.js, binding certain pattern as follow:\r\n     *  - `a`: ctrl+z => undo ctrl+y => redo\r\n     *  - `b`: ctrl+z => undo ctrl+shift+z => redo\r\n     * @method Unro#integrate\r\n     * @param {Object} accelLib \r\n     * @param {\"a\" | \"b\"} pattern \r\n     */\r\n    acquire(accelLib, pattern) {\r\n        if (accelLib.bind) {\r\n            let _this = this;\r\n            let undo = 'ctrl+w',\r\n                redo = 'ctrl+y';\r\n            if (pattern == \"b\") {\r\n                undo = 'ctrl+w';\r\n                redo = 'ctrl+shift+y';\r\n            }\r\n\r\n            accelLib.bind(undo, function () {\r\n                _this.undo();\r\n            })\r\n            accelLib.bind(redo, function () {\r\n                _this.redo();\r\n            })\r\n        }\r\n        return this\r\n    }\r\n\r\n\r\n    /**\r\n     * Define a labeled re-usable stack action handler\r\n     * @param {{ label: string, undo: (params: Object) =>, redo: (params: Object) => }} handler \r\n     */\r\n    defineHandler(handler) {\r\n        if (handler.toString() === \"[object Object]\" && typeof handler.label === \"string\" && typeof handler.undo === \"function\" && typeof handler.redo === \"function\")\r\n            this.#defined.push(handler);\r\n        else throw new Error(`UnroJs Error\\n trying to use \".defineHandler\" function with wrong parameter type or structure!`);\r\n    }\r\n\r\n    /**\r\n     * Remove handler with given `name` and return a boolean of whether deletion was successful or not\r\n     * @param {string} name \r\n     * @returns {boolean}\r\n     */\r\n    removeHandler(name) {\r\n        if (typeof name === \"string\") {\r\n            let idx = this.#defined.findIndex(a => a.label === name);\r\n            if (idx != -1) {\r\n                this.#defined.splice(idx, 1);\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Check whether handler with given `name`/label exists or not\r\n     * @param {string} name \r\n     * @returns {boolean}\r\n     */\r\n    hasHandler(name) {\r\n        return this.#defined.findIndex(a => a.label === name) != -1;\r\n    }\r\n\r\n    /**\r\n     * The length of the current stack\r\n     * @type {number}\r\n     */\r\n    get len() {\r\n        return this.#stack.length;\r\n    }\r\n}\r\n\r\nclass Stack {\r\n    #undo = dfn;\r\n    #redo = dfn;\r\n    #attrs = {};\r\n    #id = ++counter;\r\n\r\n    /**\r\n     * \r\n     * @param {StackDef} def \r\n     */\r\n    constructor(def) {\r\n        this.#undo = def.undo;\r\n        this.#redo = def.redo;\r\n        this.date = new Date();\r\n        this.label = def.label;\r\n    }\r\n\r\n    get undo() {\r\n        return this.#undo;\r\n    }\r\n\r\n    get redo() {\r\n        return this.#redo;\r\n    }\r\n\r\n    get id() {\r\n        return this.#id\r\n    }\r\n\r\n    save(key, value) {\r\n        if (typeof key === \"string\" && value != undefined)\r\n            this.#attrs[key] = value;\r\n    }\r\n    load(key) {\r\n        return key ? this.#attrs[key] : { ...this.#attrs };\r\n    }\r\n}\r\n\r\n\r\nfunction unro() {\r\n    return new Unro();\r\n}\r\n\r\nwindow.unro = unro;\r\nexport default unro;"],"names":[],"mappings":";;;;;;IAAA,MAAM,KAAK,GAAG,CAAC,WAAW,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;AACpD;IACA,MAAM,GAAG,GAAG,MAAM,EAAE,EAAC;IACrB,IAAI,OAAO,GAAG,CAAC,CAAC;IAChB,MAAM,KAAK,GAAG,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,KAAK,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;IACjE,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,GAAG,EAAE,KAAK,EAAE;IAC/C,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;IACtD,IAAI,OAAO,KAAK,CAAC;IACjB,EAAC;AACD;IACA;IACA;IACA;IACA;IACA;IACA;IACA;AACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;AACA;IACA;IACA;IACA;IACA;IACO,MAAM,IAAI,CAAC;IAClB;IACA;IACA;IACA;IACA,IAAI,MAAM,GAAG,EAAE,CAAC;AAChB;IACA;IACA;IACA;IACA;IACA,IAAI,KAAK,GAAG,IAAI,CAAC;AACjB;IACA;IACA;IACA;IACA;IACA,IAAI,QAAQ,GAAG,KAAK,CAAC;AACrB;IACA;IACA;IACA;IACA;IACA,IAAI,UAAU,GAAG,KAAK,CAAC;AACvB;IACA;IACA;IACA;IACA;IACA,IAAI,QAAQ,GAAG,EAAE,CAAC;AAClB;AACA;IACA;IACA;IACA;IACA;IACA,IAAI,MAAM,GAAG,IAAI,CAAC;AAClB;IACA,IAAI,WAAW,GAAG;AAClB;IACA;IACA;IACA;IACA;IACA,QAAQ,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;AAC1B;IACA;IACA;IACA;IACA;IACA,QAAQ,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC;AAC3B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,QAAQ,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC;AAChC;IACA,QAAQ,MAAM,KAAK,GAAG,MAAM;IAC5B,YAAY,IAAI,WAAW,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC;IAC/D,YAAY,OAAO;IACnB,gBAAgB,GAAG,EAAE,CAAC,GAAG,KAAK;IAC9B,oBAAoB;IACpB,wBAAwB,GAAG,YAAY,iCAAiC;IACxE,wBAAwB,GAAG,YAAY,wBAAwB;IAC/D;IACA,wBAAwB,WAAW,GAAG,GAAG,CAAC;IAC1C,yBAAyB,MAAM,IAAI,KAAK,CAAC,CAAC,2IAA2I,CAAC,CAAC,CAAC;IACxL,gBAAgB,CAAC;IACjB,gBAAgB,KAAK,EAAE,CAAC,GAAG,KAAK,KAAK,GAAG,GAAG;IAC3C,gBAAgB,QAAQ,EAAE,CAAC,IAAI,EAAE,GAAG,KAAK;IACzC,oBAAoB,IAAI,CAAC,WAAW,KAAK,CAAC,GAAG,KAAK,EAAE,GAAG,YAAY,iCAAiC,CAAC,IAAI,EAAE,GAAG,YAAY,wBAAwB,CAAC,CAAC,CAAC;IACrJ,wBAAwB,MAAM,IAAI,KAAK,CAAC,CAAC,oEAAoE,CAAC,CAAC;IAC/G,oBAAoB,MAAM,CAAC,GAAG,GAAG,IAAI,WAAW,CAAC;IACjD,oBAAoB,QAAQ,IAAI;IAChC,wBAAwB,KAAK,MAAM;IACnC,4BAA4B,IAAI,GAAG,CAAC,YAAY,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IACtH,4BAA4B,MAAM;IAClC,wBAAwB,KAAK,MAAM;IACnC,4BAA4B,IAAI,GAAG,CAAC,YAAY,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IACtH,4BAA4B,MAAM;IAClC,qBAAqB;IACrB,gBAAgB,CAAC;IACjB,gBAAgB,KAAK,EAAE,CAAC,IAAI,EAAE,EAAE,KAAK;IACrC,oBAAoB,IAAI,IAAI,KAAK,MAAM,IAAI,OAAO,EAAE,KAAK,UAAU;IACnE,wBAAwB,MAAM,GAAG,EAAE,CAAC;IACpC,yBAAyB,IAAI,IAAI,KAAK,MAAM,IAAI,OAAO,EAAE,KAAK,UAAU;IACxE,wBAAwB,MAAM,GAAG,EAAE,CAAC;IACpC,yBAAyB,IAAI,OAAO,IAAI,KAAK,UAAU,EAAE;IACzD,wBAAwB,MAAM;IAC9B,4BAA4B,MAAM;IAClC,4BAA4B,IAAI,CAAC;IACjC,oBAAoB,CAAC;IACrB,gBAAgB,CAAC;IACjB,gBAAgB,OAAO,EAAE,YAAY;IACrC,oBAAoB,IAAI,EAAE,IAAI,YAAY,IAAI,CAAC;IAC/C,wBAAwB,MAAM,IAAI,KAAK,CAAC,CAAC,yEAAyE,CAAC,CAAC,CAAC;IACrH,oBAAoB,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW;IACtD,wBAAwB,MAAM,IAAI,KAAK,CAAC,CAAC,gLAAgL,CAAC,CAAC,CAAC;IAC5N,oBAAoB,IAAI,GAAG,GAAG,IAAI,KAAK,CAAC;IACxC,wBAAwB,IAAI,EAAE,YAAY;IAC1C,4BAA4B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACtF,4BAA4B,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC;IAC7E,wBAAwB,CAAC;IACzB,wBAAwB,IAAI,EAAE,YAAY;IAC1C,4BAA4B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACtF,4BAA4B,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC;IAC7E,wBAAwB,CAAC;IACzB,wBAAwB,KAAK;IAC7B,qBAAqB,CAAC,CAAC;IACvB,oBAAoB,GAAG,CAAC,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;IACpD,oBAAoB,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;IAC3C,oBAAoB,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;IAC3C,oBAAoB,IAAI,OAAO,MAAM,KAAK,UAAU,EAAE,GAAG,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;IAClF,oBAAoB,IAAI,OAAO,MAAM,KAAK,UAAU,EAAE,GAAG,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;IAClF,oBAAoB,OAAO,GAAG,CAAC;IAC/B,gBAAgB,CAAC;IACjB,gBAAgB,IAAI,EAAE,YAAY;IAClC,oBAAoB,IAAI,EAAE,IAAI,YAAY,IAAI,CAAC;IAC/C,wBAAwB,MAAM,IAAI,KAAK,CAAC,CAAC,sEAAsE,CAAC,CAAC,CAAC;IAClH,oBAAoB,IAAI;IACxB,wBAAwB,IAAI;IAC5B,wBAAwB,KAAK;IAC7B,wBAAwB,WAAW,GAAG,SAAS,CAAC;IAChD;IACA,gBAAgB,CAAC;IACjB,aAAa;IACb,QAAQ,EAAC;AACT;IACA,QAAQ,IAAI,CAAC,MAAM,GAAG,KAAK,EAAE,CAAC;IAC9B,IAAI,CAAC;AACL;AACA;IACA,IAAI,IAAI,UAAU,GAAG;IACrB,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC;IAC1B,IAAI,CAAC;AACL;IACA,IAAI,IAAI,YAAY,GAAG;IACvB,QAAQ,OAAO,IAAI,CAAC,UAAU,KAAK,IAAI,CAAC;IACxC,IAAI,CAAC;AACL;IACA,IAAI,IAAI,WAAW,GAAG;IACtB,QAAQ,OAAO,IAAI,CAAC,QAAQ,KAAK,IAAI,CAAC;IACtC,IAAI,CAAC;AACL;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,IAAI,CAAC,QAAQ,EAAE,MAAM,EAAE;IAC3B,QAAQ,IAAI,CAAC,QAAQ;IACrB,aAAa,QAAQ,CAAC,QAAQ,EAAE,KAAK,iBAAiB;IACtD,gBAAgB,CAAC,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,QAAQ,CAAC,OAAO,QAAQ,CAAC,CAAC,EAAE,OAAO;AAC3E;IACA,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;IAC1C,YAAY,IAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,KAAK,QAAQ,CAAC,CAAC;IACpE,YAAY,IAAI,GAAG;IACnB,gBAAgB,QAAQ,GAAG;IAC3B,oBAAoB,IAAI,EAAE,YAAY;IACtC,wBAAwB,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACzC,oBAAoB,CAAC;IACrB,oBAAoB,IAAI,EAAE,YAAY;IACtC,wBAAwB,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACzC,oBAAoB,CAAC;IACrB,kBAAiB;IACjB,iBAAiB,OAAO;IACxB,QAAQ,CAAC;IACT,QAAQ,IAAI,KAAK,CAAC;IAClB,QAAQ,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;IAC5C,YAAY,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAClC,YAAY,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACnD,YAAY,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACxC,QAAQ,CAAC,MAAM,IAAI,OAAO,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,OAAO,QAAQ,CAAC,IAAI,IAAI,UAAU;IAC3F,YAAY,MAAM,IAAI,KAAK,CAAC,CAAC,wFAAwF,CAAC,CAAC,CAAC;IACxH,aAAa,KAAK,GAAG,IAAI,KAAK,CAAC,QAAQ,CAAC,CAAC;AACzC;IACA;IACA,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC;AACpC;IACA,QAAQ,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS;IACnC,YAAY,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACvD,aAAa,IAAI,IAAI,CAAC,IAAI,KAAK,WAAW,EAAE;IAC5C,YAAY,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,CAAC,CAAC,KAAK,SAAS;IACvD,gBAAgB,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,GAAG,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IACrE,YAAY,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACvD,QAAQ,CAAC,MAAM,IAAI,IAAI,CAAC,IAAI,KAAK,WAAW,EAAE;IAC9C,YAAY,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,QAAQ,GAAG,CAAC,CAAC,CAAC;IACnE,QAAQ,CAAC;AACT;IACA;IACA,QAAQ,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,EAAE;IAC/C,YAAY,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;IAChC,YAAY,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC;IACpC,QAAQ,CAAC;AACT;IACA,QAAQ,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;IAChC,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC;IAC5B,IAAI,CAAC;IACL;IACA;IACA;IACA;IACA;IACA,IAAI,IAAI,GAAG;IACX,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE,OAAO;IACpC;IACA,QAAQ,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC;IAC5B,QAAQ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC7C;IACA,QAAQ,IAAI,IAAI,CAAC,OAAO,GAAG,EAAE;IAC7B,YAAY,IAAI,CAAC,OAAO,EAAE,CAAC;IAC3B,QAAQ,IAAI,IAAI,CAAC,OAAO,GAAG,CAAC;IAC5B,YAAY,OAAO,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;AAC1C;IACA,QAAQ,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;IAC9B,QAAQ,OAAO,IAAI,CAAC;IACpB,IAAI,CAAC;IACL;IACA;IACA;IACA;IACA;IACA,IAAI,IAAI,GAAG;IACX;IACA,QAAQ,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IACzC,YAAY,IAAI,CAAC,OAAO,EAAE,CAAC;IAC3B,aAAa,OAAO,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;AACzC;IACA;IACA,QAAQ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC7C,QAAQ,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC;IAC5B,QAAQ,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;IAChC,QAAQ,OAAO,IAAI,CAAC;IACpB,IAAI,CAAC;IACL;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,MAAM,CAAC,KAAK,EAAE;IAClB,QAAQ,IAAI,CAAC,OAAO,GAAG,OAAO,KAAK,IAAI,QAAQ,GAAG,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;IACvE,QAAQ,OAAO,IAAI;IACnB,IAAI,CAAC;IACL;IACA;IACA;IACA;IACA;IACA,IAAI,IAAI,GAAG;IACX,QAAQ,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;IACzB,QAAQ,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IACzB,QAAQ,OAAO,IAAI;IACnB,IAAI,CAAC;IACL;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,MAAM,CAAC,CAAC,EAAE;IACd,QAAQ,IAAI,CAAC,KAAK,IAAI,CAAC,OAAO,EAAE,OAAO,SAAS,CAAC;IACjD,QAAQ,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;IAC5B;IACA;IACA;IACA,YAAY,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO;IAChC,gBAAgB,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;IAC5D,oBAAoB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IACrC,oBAAoB,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC9C,gBAAgB,CAAC;IACjB;IACA,gBAAgB,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;IACxD,oBAAoB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IACrC,oBAAoB,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC9C,gBAAgB,CAAC;AACjB;IACA,YAAY,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IAC7B,YAAY,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IAClC,QAAQ,CAAC,MAAM,OAAO,cAAc,CAAC;IACrC,IAAI,CAAC;IACL;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,aAAa,CAAC,IAAI,EAAE;IACxB,QAAQ,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;IAClC,YAAY,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IAC7B,YAAY,OAAO,IAAI;IACvB,QAAQ,CAAC;IACT,QAAQ,OAAO,KAAK;IACpB,IAAI,CAAC;AACL;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,kBAAkB,GAAG;IACzB,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;IACxB,QAAQ,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,GAAG,CAAC,KAAK,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;IACvF,QAAQ,OAAO,IAAI,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;IAC1C,IAAI,CAAC;AACL;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,OAAO,CAAC,QAAQ,EAAE,OAAO,EAAE;IAC/B,QAAQ,IAAI,QAAQ,CAAC,IAAI,EAAE;IAC3B,YAAY,IAAI,KAAK,GAAG,IAAI,CAAC;IAC7B,YAAY,IAAI,IAAI,GAAG,QAAQ;IAC/B,gBAAgB,IAAI,GAAG,QAAQ,CAAC;IAChC,YAAY,IAAI,OAAO,IAAI,GAAG,EAAE;IAChC,gBAAgB,IAAI,GAAG,QAAQ,CAAC;IAChC,gBAAgB,IAAI,GAAG,cAAc,CAAC;IACtC,YAAY,CAAC;AACb;IACA,YAAY,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY;IAC5C,gBAAgB,KAAK,CAAC,IAAI,EAAE,CAAC;IAC7B,YAAY,CAAC,EAAC;IACd,YAAY,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY;IAC5C,gBAAgB,KAAK,CAAC,IAAI,EAAE,CAAC;IAC7B,YAAY,CAAC,EAAC;IACd,QAAQ,CAAC;IACT,QAAQ,OAAO,IAAI;IACnB,IAAI,CAAC;AACL;AACA;IACA;IACA;IACA;IACA;IACA,IAAI,aAAa,CAAC,OAAO,EAAE;IAC3B,QAAQ,IAAI,OAAO,CAAC,QAAQ,EAAE,KAAK,iBAAiB,IAAI,OAAO,OAAO,CAAC,KAAK,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,IAAI,KAAK,UAAU,IAAI,OAAO,OAAO,CAAC,IAAI,KAAK,UAAU;IACrK,YAAY,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACxC,aAAa,MAAM,IAAI,KAAK,CAAC,CAAC,8FAA8F,CAAC,CAAC,CAAC;IAC/H,IAAI,CAAC;AACL;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,aAAa,CAAC,IAAI,EAAE;IACxB,QAAQ,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;IACtC,YAAY,IAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC;IACrE,YAAY,IAAI,GAAG,IAAI,EAAE,EAAE;IAC3B,gBAAgB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IAC7C,gBAAgB,OAAO,IAAI,CAAC;IAC5B,YAAY,CAAC;IACb,QAAQ,CAAC;IACT,QAAQ,OAAO,KAAK,CAAC;IACrB,IAAI,CAAC;AACL;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,UAAU,CAAC,IAAI,EAAE;IACrB,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,IAAI,EAAE,CAAC;IACpE,IAAI,CAAC;AACL;IACA;IACA;IACA;IACA;IACA,IAAI,IAAI,GAAG,GAAG;IACd,QAAQ,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;IAClC,IAAI,CAAC;IACL,CAAC;AACD;IACA,MAAM,KAAK,CAAC;IACZ,IAAI,KAAK,GAAG,GAAG,CAAC;IAChB,IAAI,KAAK,GAAG,GAAG,CAAC;IAChB,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,IAAI,GAAG,GAAG,EAAE,OAAO,CAAC;AACpB;IACA;IACA;IACA;IACA;IACA,IAAI,WAAW,CAAC,GAAG,EAAE;IACrB,QAAQ,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC;IAC9B,QAAQ,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC;IAC9B,QAAQ,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;IAC/B,QAAQ,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;IAC/B,IAAI,CAAC;AACL;IACA,IAAI,IAAI,IAAI,GAAG;IACf,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC;IAC1B,IAAI,CAAC;AACL;IACA,IAAI,IAAI,IAAI,GAAG;IACf,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC;IAC1B,IAAI,CAAC;AACL;IACA,IAAI,IAAI,EAAE,GAAG;IACb,QAAQ,OAAO,IAAI,CAAC,GAAG;IACvB,IAAI,CAAC;AACL;IACA,IAAI,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE;IACrB,QAAQ,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,KAAK,IAAI,SAAS;IACzD,YAAY,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;IACrC,IAAI,CAAC;IACL,IAAI,IAAI,CAAC,GAAG,EAAE;IACd,QAAQ,OAAO,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;IAC3D,IAAI,CAAC;IACL,CAAC;AACD;AACA;IACA,SAAS,IAAI,GAAG;IAChB,IAAI,OAAO,IAAI,IAAI,EAAE,CAAC;IACtB,CAAC;AACD;IACA,MAAM,CAAC,IAAI,GAAG,IAAI;;;;;;;;;;;"}